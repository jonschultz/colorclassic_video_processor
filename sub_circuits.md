![video](video_schem_20251102A.png)
#
# Horizontal Section
<br>
The high-level function of the horizontal section is to take the composite sync signal provided on the Color Classic analog board ("AB"), extract a horizontal sync signal, and then use that to generate the horizontal deflection pulse within the required range of duty cycle. The horizontal deflection pulse is used to ultimately pulse the horizontal output transistor on the AB.
<br><br>

## Signal Chain:
<br>
* The LM1881 IC is used to provide a DC-coupled, approx 0-6V composite sync ("CSYNC") signal, using the AB's AC-coupled CSYNC singal as input. The LM1881 provides other functions that will be described in later sections. But here, the "copy" of the CSYNC signal is useful as a low-ouptut impedance input to the horizontal circuitry. The CSYNC falling edge represents the start of a scanline.<br>
* CSYNC pulls a simple voltage regulator of two 3.3V Zener diodes to ground when high with a BJT inverter, conversely producing 6.6V at the falling edge.<br>
* The 6.6V pulse is buffered and drives a simple edge detector comprised of an RC network. A quickly decaying exponential pulse results (about 1μs in duration), independent of the duty cycle of the CSYNC input. This allows the circuity to generate all pulses nearly equally in amplitude and duration, whether the input pulse is at the start of the scanline or during the vertical sync period when the duty cycle is larger.<br>
* Two BJTs are used to "clean" and buffer the pulse into a more digital signal. In effect, this generates a horizontal sync ("HSYNC") signal.<br>
* Independently, a BJT current source (referenced to the 8V rail) linearly charges a 5nF accumulator capacitor to produce a linear voltage ramp.<br>
* The HSYNC pulse is then used to reset the accumulator to ground potential at the horizontal frequency at the start of every scanline. The resulting sawtooth waveform is buffered by a PNP BJT, with an output voltage between 0.6V and 2.8V.<br>
* Two reference voltage ("V1" and "V2") are generated with BJT voltage followers (with different levels of buffering), using a simple resistive voltage divider as the input referece. The divider uses Pin 40 (the "horizontal shift") signal as input, with a gain reduction forced by another voltage divider with input from the 5V rail (described in a later section). The nominal voltage generated by this gain-reducing divider, and Pin 40 itself, is 1.7V, which is the approximate voltage buffered by the downstream V2 source.<br>
* Two BJTs serve as comparators between the sawtooth waveform and the V1 and V2 reference voltages. Their collectors pull low to their reference voltages as the sawtooth crosses their respective values (plus Vbe).<br>
* The V1 comparator pulls a switching PNP BJT's base low at the first crossing, while the V2 comparator pulls it back to high with a second BJT on the second crossing (threshold logic). This generates a voltage pulse that is timed according the precise voltages of V1 and V2, each dependent on the exact voltage at Pin 40 (allowing slight modulation with the HS potentiometer on the AB). The nominal timing difference between the first and second crossing should be around 11μs for proper operation of the horizontal deflection, but there is some significant tolerance. This difference is a function of the Pin 40 voltage due to the simple voltage division mentioned above. More importantly, the Pin 40 voltage modulates V2, which directly affects the timing of the second crossing, and thereby affects the overall phase of the horizontal scan in relation to CSYNC.<br>
* The switching of the threshold logic BJT is inverted and buffered by another switching BJT. This signal is applied to Pin 32, which drives a MOSFET on the AB and ultimately drives the rest of the horizontal section. The timing of the rising edge of this final output pulse controls the phase of the horizontal scan in relation to all other signals (especially the video signals). This edge should occur about 28μs after the falling edge of CSYNC in order to have a well-centered image (at 31.5kHz horizontal scan frequency).
<br><br><br>

## Considerations:
<br>
* It may be clear from the description of the signal path above that much of the horizontal circuity is a kind of "one-shot" timer that converts an HSYNC pulse train into another "digital" pulse with a particular delay and duty cycle. As such, there are many ways of implementing this functionality. I've chosen to use mostly discrete components and build from low-level functionality. This has given me a lot of control over the behavior of the circuitry. But timing of the final horizontal drive pulse, as well as the voltage level and output impedance are important.<br>
* Like the other sub-circuits, the supply voltage is 8V from the Pin 22 position. This appears to be the main rail for powering the XCll86B, though there appear to be other supply voltages (more on that later). The grounding approach for all the sub-circuits is especially important for avoiding video artifacts. Through experimentation, I've found that associating all the horizontal circuitry with Pin 31 ground (#3 in my schematic) is best, which is physically closest to the pins associated with the horizontal section.<br>
* A lot of trial and error was employeed to make the timing stable, especially with respect to temperature. Use of accumulator capacitors with low temperature sensitivity is particularly important, as well as using a small voltage rise. The high linearity and lower temperature sensitivity outweigh any SNR benefit in this regime. Having a very stable "V2" is also critical, and I found that the dual-stage regulator/buffer was necessary to achieve this. Small changes in the Vbe of each BJT can contribute to temperature-sensitive drift in all of the circuitry, so paired NPN/PNP stages help to null out this effect, as well as to reduce base current in general, leading to more stable Vbe.<br>
* The C10 capacitor was originally connected in parallel with R45, in order to slow the discharge of the base voltage on Q21. The purpose of this was to avoid a short secondary pulse at the output when the sawtooth waveform falls sharply on the negative edge, switching the threshold circuitry in reverse order. These events happen on the time scale of a few microseconds, and as such, Q21 is discharges its base slowly enough without C10. The use of a relatively large resistance on R45 provides some discharge function (necessary to "reset" the circuitry quickly engough for the next cycle), but is slow enough to avoid generating the secondary pulse.<br>
* All BJTs used are S8050s (NPN) or S8550s (PNP), unless otherwise noted. These are well matched BJTs that are reasonably fast for this application and have good gain. The final output transistor at Q22 requires a little more collector current handling, and I've opted for FMMT449. A more complete recommended parts list will be provided in another section.
<br><br>
#

# Vertical Section
<br>
The vertical section's main function is to generate a sawtooth waveform that represents the beam displacement from the top of the display to the bottom, with the lowest voltage value at representing the start of the scan at the top. This waveform drives the TDA8172, which is sort of high-power opamp that directly drives the vertical deflection coil. Other sections of the AB also make use of the vertical deflection waveform, as discussed below. From probing the output of the original XC1186B, it was found that the vertical deflection sawtooth ranges from about 1.5V to 5.4V, with a high degree of linearity.
<br><br>

## Signal Chain:
<br>
* The LM1881 IC is used to generate a VSYNC signal, extract from the AC-coupled CSYNC provided by the AB on the Pin 6 position.<br>
* Independently, a simple current source and a 10 microfarad accumulator capacitor generate a linear voltage rise at around 33 V/s, or about 0.5V over the period of a single 60 Hz refresh. The exact current is adjustable by way of the AB's "VH" potentiometer, which is input on the Pin 39 position. VH forms a voltage divider with a 5V supply (described below), the output of which modulates a level shifter that drives the BJT current source.<br>
* The voltage on the accumulator capacitor is reset to around 0.9V, provided by a simple voltage regulator and 100 microfarad decoupling capacitor, with a BJT that's driven by the VSYNC signal as a triggering pulse. The video processor's 5V supply piggybacks off this regulator's Zener reference, and provides 5V output on the Pin 7 position.<br>
* The amplitude of the accumulator capacitor is intentionally kept low (0.5V as described above) in order to maintain high linearity of voltage with respect to time.<br>
* The accumulator's signal is then amplified by a dual-BJT feedback amplifier with adjustable gain via a 2k potentiometer. The output of this stage produces the 1.5V to 5.4V sawtooth waveform required as input to the downstream circuitry of the AB, including the TDA8172. Due to part tolerances, user adjustment of the gain potentiometer is necessary to grossly bring the vertical sawtooth amplitude into the correct range, which has a direct impact on the height of image. The "VH" potentiometer on the rear of the AB allows for fine-tuning of the image height, just as would be the case with the XC1186B.<br>
<br><br><br>

## Considerations:
More to come!
